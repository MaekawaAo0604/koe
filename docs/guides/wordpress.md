# WordPress で Koe を埋め込む

WordPress には複数の環境があり、**お使いの環境によって手順が異なります**。まず、ご自身の環境を確認してください。

---

## まず確認: あなたの WordPress はどれ？

| 環境 | `<script>` タグ | 対応状況 |
|------|-----------------|----------|
| **セルフホスト WordPress**（自分でサーバーにインストール） | 使える | ✅ 対応 |
| **WordPress.com ビジネスプラン以上**（プラグイン利用可） | 使える | ✅ 対応 |
| **WordPress.com 無料 / パーソナル / プレミアムプラン** | **使えない** | ❌ 非対応 |

> **重要**: WordPress.com の無料・パーソナル・プレミアムプランでは、セキュリティ上の理由により `<script>` タグが除去されます。`embed` `iframe` `form` `input` `style` `link` 等のタグもプラグイン対応サイトのみで利用可能です。

---

## ✅ セルフホスト WordPress / WordPress.com ビジネスプラン以上

### 方法A: カスタムHTMLブロックで貼る（おすすめ）

お客様の声を表示したい**特定のページ**に埋め込む方法です。

1. WordPress管理画面 → 表示したいページの「編集」を開く
2. ブロックエディタ（Gutenberg）で「+」ボタン → 「カスタム HTML」ブロックを追加
3. Koeの埋め込みコードを貼り付け:

```html
<script src="https://あなたのURL/widget.js" data-project="あなたのプロジェクトID" data-widget="あなたのウィジェットID"></script>
```

4. 「プレビュー」タブで表示を確認
5. 「更新」または「公開」をクリック

### 方法B: ヘッダー挿入プラグインで貼る（全ページ共通）

**全ページ**にお客様の声を表示したい場合はこちら。

1. WordPress管理画面 → プラグイン → 「新規追加」
2. 「Insert Headers and Footers」等のヘッダー挿入プラグインをインストール・有効化
3. プラグインの設定画面で「Scripts in Footer」欄にKoeの埋め込みコードを貼り付け:

```html
<script src="https://あなたのURL/widget.js" data-project="あなたのプロジェクトID" data-widget="あなたのウィジェットID"></script>
```

4. 保存して、サイトを表示して確認

### 方法C: テーマファイルに直接貼る（上級者向け）

1. WordPress管理画面 → 外観 → テーマファイルエディタ
2. `footer.php` を開く
3. `</body>` の直前にKoeの埋め込みコードを貼り付け
4. 「ファイルを更新」をクリック

> **注意**: テーマを更新すると上書きされます。子テーマの `footer.php` に記述するか、方法A・Bの利用をおすすめします。

---

## ❌ WordPress.com 無料 / パーソナル / プレミアムプラン

これらのプランでは `<script>` タグがセキュリティ上の理由で**自動的に除去**されるため、Koeのウィジェットを直接埋め込むことができません。

### 選択肢

1. **WordPress.com ビジネスプラン以上にアップグレード** → `<script>` タグが利用可能になります
2. **セルフホスト WordPress に移行** → 制限なく利用できます
3. **Wall of Love ページへのリンクを掲載** → Koeが自動生成する公開ページのURLをサイトに貼ることで、お客様の声を見せることは可能です

---

## よくある問題

### 「カスタム HTML」ブロックで貼ったが表示されない

- ブロックエディタの「プレビュー」ではなく、実際のページURL で確認してください
- キャッシュプラグイン（WP Super Cache, W3 Total Cache等）を使っている場合、キャッシュをクリアしてください

### セキュリティプラグインにブロックされる

一部のセキュリティプラグイン（Wordfence, Sucuri等）が外部スクリプトをブロックする場合があります。
- プラグインの設定で Koe のドメインをホワイトリストに追加してください

その他の問題は [トラブルシューティング](troubleshooting.md) を参照してください。
